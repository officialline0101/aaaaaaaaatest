<!DOCTYPE html>
<html lang="ja">
<head>
<base target="_top">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@3.2/dist/vue.global.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/@vuepic/vue-datepicker@latest/dist/main.css">
<meta name="csrf-token" content="{{ csrf_token() }}">
<style>
    .dp__button {
        display: none;
    }
    * {
        font-family: "游ゴシック Medium", YuGothic, YuGothicM, "Hiragino Kaku Gothic ProN", "Hiragino Kaku Gothic Pro", メイリオ, Meiryo, sans-serif;
    }
    body {
        margin: 0;
    }
    header {
        padding: 5px;
        background-color: #333;
        position: relative;
    }
    h2 {
        text-align: center;
        color: #fff;
        margin: 10px;
    }
    .btn-group>.btn, .btn-group-vertical>.btn {
        float: none;
        display: inline-block;
    }
    .btn-info {
        color: #fff;
        background-color: #333;
        border-color: #FFF;
    }
    .btn-info:focus, .btn-info:active, .btn-info.active, .open>.dropdown-toggle.btn-info, .check {
        color: #333;
        background-color: #fff;
        border: solid 2px #333;
    }
    .container {
        margin: 40px 0;
    }
    .form-group {
        margin-bottom: 20px;
    }
    .use-span {
        width: 25%;
        font-size: 12px;
        padding: 6px;
        text-align: center;
    }
    .regist {
        background: red;
        border-color: red;
        width: 100%;
        padding: 20px 0;
        margin: 20px 0;
        color: #FFFFFF;
    }
    #error {
        display: none;
    }
    #section {
        display: none;
    }
    #family_count {
        display: none;
    }
    .dp__input {
        display: block;
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        padding-left: 24px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
    }
    .dp__action_buttons {
        flex: auto;
    }
    input[type=radio] {
        display: none;
    }
</style>
</head>
<body>
<header>
    <h2>予約フォーム</h2>
</header>
<section id="app">
    <div class="container" id="bring">
        <div class="form-group">
            <label>お客様名（カタカナ）</label>
            <input v-model="name" type="text" name="customer_name" class="form-control" required>
        </div>

        <div class="form-group">
            <label>電話番号</label>
            <input v-model="tel" type="text" name="customer_tel" class="form-control" required>
        </div>

        <div class="form-group">
            <label>ご来店回数</label>
            <div class="btn-group" style="width:100%;">
                <label class="btn btn-info" style="width: 49%;" for="first" :class="number === '初めて' ? 'check' : ''">
                    <input value="初めて" type="radio" v-model="number" id="first">初めて
                </label>
                <label class="btn btn-info" style="width: 49%;" for="second" :class="number === '2回目以降' ? 'check' : ''">
                    <input value="2回目以降" type="radio" v-model="number" id="second">2回目以降
                </label>
            </div>
        </div>

        <div class="form-group">
            <label>症状</label>
            <div class="btn-group" style="width:100%;">
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '頭痛・偏頭痛' ? 'check' : ''" for="one">
                    <input name="place" value="頭痛・偏頭痛" type="radio" required v-model="syoujou" id="one">頭痛・偏頭痛
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '交通事故施術' ? 'check' : ''" for="two">
                    <input name="place" value="交通事故施術" type="radio" required v-model="syoujou" id="two">交通事故施術
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '肩こり・腕のしびれ' ? 'check' : ''" for="three">
                    <input name="place" value="肩こり・腕のしびれ" type="radio" required v-model="syoujou" id="three">肩こり・腕のしびれ
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '臀部・下肢の痛みや痺れ' ? 'check' : ''" for="four">
                    <input name="place" value="臀部・下肢の痛みや痺れ" type="radio" required v-model="syoujou" id="four">臀部・下肢の痛みや痺れ
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === 'ぎっくり腰・慢性腰痛' ? 'check' : ''" for="five">
                    <input name="place" value="ぎっくり腰・慢性腰痛" type="radio" required v-model="syoujou" id="five">ぎっくり腰・慢性腰痛
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '寝違い・むち打ち等首の症状' ? 'check' : ''" for="six">
                    <input name="place" value="寝違い・むち打ち等首の症状" type="radio" required v-model="syoujou" id="six">寝違い・むち打ち等首の症状
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === 'EMS(電気的筋肉刺激装置)トレーニング' ? 'check' : ''" for="six">
                    <input name="place" value="EMS(電気的筋肉刺激装置)トレーニング" type="radio" required v-model="syoujou" id="six">EMS(電気的筋肉刺激装置)トレーニング
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === '健康保険の施術' ? 'check' : ''" for="six">
                    <input name="place" value="健康保険の施術" type="radio" required v-model="syoujou" id="six">健康保険の施術
                </label>
                <label class="btn btn-info" style="width: 100%;" :class="syoujou === 'その他' ? 'check' : ''" for="seven">
                    <input name="place" value="その他" type="radio" required v-model="syoujou" id="seven">その他
                </label>
            </div>
        </div>

        <div class="form-group">
            <label>第１希望日</label>
            <datepicker v-model="datepicker1" :format="'yyyy-MM-dd'" :monday-first="true"></datepicker>
        </div>

        <div class="form-group">
            <label>第１希望時間</label>
            <select v-model="datepicker1time" name="time1" class="form-control">
                <option value="" disabled>選択してください</option>
                <option value="9:00">9:00</option>
                <option value="9:30">9:30</option>
                <option value="10:00">10:00</option>
                <option value="10:30">10:30</option>
                <option value="11:00">11:00</option>
                <option value="11:30">11:30</option>
                <option value="12:00">12:00</option>
                <option value="12:30">12:30</option>
                <option value="13:00">13:00</option>
                <option value="13:30">13:30</option>
                <option value="14:00">14:00</option>
                <option value="14:30">14:30</option>
                <option value="15:00">15:00</option>
                <option value="15:30">15:30</option>
                <option value="16:00">16:00</option>
                <option value="16:30">16:30</option>
                <option value="17:00">17:00</option>
                <option value="17:30">17:30</option>
                <option value="18:00">18:00</option>
                <option value="18:30">18:30</option>
                <option value="19:00">19:00</option>
            </select>
        </div>

        <div class="form-group">
            <label>第２希望日</label>
            <datepicker v-model="datepicker2" :format="'yyyy-MM-dd'" :monday-first="true"></datepicker>
        </div>

        <div class="form-group">
            <label>第２希望時間</label>
            <select v-model="datepicker2time" name="time2" class="form-control">
                <option value="" disabled>選択してください</option>
                <option value="9:00">9:00</option>
                <option value="9:30">9:30</option>
                <option value="10:00">10:00</option>
                <option value="10:30">10:30</option>
                <option value="11:00">11:00</option>
                <option value="11:30">11:30</option>
                <option value="12:00">12:00</option>
                <option value="12:30">12:30</option>
                <option value="13:00">13:00</option>
                <option value="13:30">13:30</option>
                <option value="14:00">14:00</option>
                <option value="14:30">14:30</option>
                <option value="15:00">15:00</option>
                <option value="15:30">15:30</option>
                <option value="16:00">16:00</option>
                <option value="16:30">16:30</option>
                <option value="17:00">17:00</option>
                <option value="17:30">17:30</option>
                <option value="18:00">18:00</option>
                <option value="18:30">18:30</option>
                <option value="19:00">19:00</option>
            </select>
        </div>

        <div class="form-group">
            <label>第３希望日</label>
            <datepicker v-model="datepicker3" :format="'yyyy-MM-dd'" :monday-first="true"></datepicker>
        </div>

        <div class="form-group">
            <label>第３希望時間</label>
            <select v-model="datepicker3time" name="time3" class="form-control">
                <option value="" disabled>選択してください</option>
                <option value="9:00">9:00</option>
                <option value="9:30">9:30</option>
                <option value="10:00">10:00</option>
                <option value="10:30">10:30</option>
                <option value="11:00">11:00</option>
                <option value="11:30">11:30</option>
                <option value="12:00">12:00</option>
                <option value="12:30">12:30</option>
                <option value="13:00">13:00</option>
                <option value="13:30">13:30</option>
                <option value="14:00">14:00</option>
                <option value="14:30">14:30</option>
                <option value="15:00">15:00</option>
                <option value="15:30">15:30</option>
                <option value="16:00">16:00</option>
                <option value="16:30">16:30</option>
                <option value="17:00">17:00</option>
                <option value="17:30">17:30</option>
                <option value="18:00">18:00</option>
                <option value="18:30">18:30</option>
                <option value="19:00">19:00</option>
            </select>
        </div>

        <div class="form-group">
            <label>ご要望・ご質問等</label>
            <textarea v-model="message" name="message" class="form-control"></textarea>
        </div>

        <div id="error" class="alert alert-danger" role="alert">
            すべてのフィールドを入力してください。
        </div>

        <button type="button" @click="done" class="btn btn-primary">送信</button>
    </div>
</section>

<script src="https://unpkg.com/@vuepic/vue-datepicker@latest"></script>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
const { Datepicker } = window.VueDatePicker;

const app = {
    data() {
        return {
            datepicker1: '',
            datepicker2: '',
            datepicker3: '',
            datepicker1time: '',
            datepicker2time: '',
            datepicker3time: '',
            name: "",
            syoujou: "",
            number: "",
            tel: "",
            message: ""
        }
    },
    components: {
        Datepicker
    },
    methods: {
        get() {
            let url = new URL(window.location.href);
            let params = url.searchParams;
            let syoujou = params.get('name');
            this.syoujou = syoujou;
        },
        done() {
            if (this.name && this.tel && this.number && this.syoujou && this.datepicker1 && this.datepicker1time && this.datepicker2 && this.datepicker2time && this.datepicker3 && this.datepicker3time && this.message) {
                axios.post('/submit', {
                    name: this.name,
                    tel: this.tel,
                    number: this.number,
                    syoujou: this.syoujou,
                    datepicker1: this.datepicker1,
                    datepicker1time: this.datepicker1time,
                    datepicker2: this.datepicker2,
                    datepicker2time: this.datepicker2time,
                    datepicker3: this.datepicker3,
                    datepicker3time: this.datepicker3time,
                    message: this.message
                })
                .then(response => {
                    alert('送信が完了しました。');
                })
                .catch(error => {
                    alert('送信に失敗しました。');
                });
            } else {
                document.getElementById('error').style.display = 'block';
            }
        }
    },
    mounted: async function(){
        await liff.init({
            liffId: "2004727608-aZejr9x5"
        }).then(()=>{
            if (liff.isLoggedIn()) {
                console.log("ログイン済");
            } else {
                liff.login();
            }
        });
    },
    created() {
        this.get();
    }
}

Vue.createApp(app).mount('#bring');
</script>
</body>
</html>
