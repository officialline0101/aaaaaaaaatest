<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出張買取予約フォーム</title>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <style>
        /* 全体のフォント設定（画像に合わせて明朝体・セリフ体を優先） */
        body {
            font-family: "Yu Mincho", "YuMincho", "Hiragino Mincho ProN", "HGS Mincho E", serif;
            background-color: #aaaaaa; /* 画像の背景色に合わせたグレー */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px 0;
            color: #333;
        }

        .container {
            background-color: #fff;
            border-radius: 4px; /* 角を少しだけ丸くして上品に */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 600px;
            padding: 30px;
            box-sizing: border-box;
        }

        /* ヘッダーデザイン（ロゴイメージに合わせる） */
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            font-weight: normal;
            letter-spacing: 0.1em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 15px;
        }

        /* ラベルスタイル */
        .label {
            display: block;
            margin-top: 20px;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 15px;
            color: #000;
        }

        /* 必須マーク */
        .required {
            background-color: #333; /* 黒に変更 */
            color: #fff;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 2px;
            margin-left: 8px;
            vertical-align: middle;
            font-weight: normal;
        }

        .optional {
            background-color: #999;
            color: #fff;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 2px;
            margin-left: 8px;
            vertical-align: middle;
            font-weight: normal;
        }

        /* 入力フィールド */
        input[type="text"],
        input[type="tel"],
        input[type="datetime-local"],
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 5px;
            border: 1px solid #ccc;
            border-radius: 0px; /* 高級感を出すため角丸をなくす、または小さく */
            box-sizing: border-box;
            font-size: 16px;
            font-family: sans-serif; /* 入力文字は読みやすいゴシック体で */
            background-color: #f9f9f9;
            transition: all 0.3s;
        }

        input:focus,
        textarea:focus {
            border-color: #555;
            outline: none;
            background-color: #fff;
        }

        /* ボタンエリア */
        .selection-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .selection-group button {
            flex: 1;
            padding: 12px;
            border: 1px solid #ccc;
            background-color: #fff;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            font-family: serif;
        }

        .selection-group button.active {
            background-color: #333; /* 選択時は黒 */
            color: #fff;
            border-color: #333;
        }

        /* 日時入力エリア */
        .date-group {
            margin-bottom: 15px;
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
        }
        .date-label {
            font-size: 13px;
            margin-bottom: 5px;
            display: block;
            color: #555;
        }

        /* 送信ボタン */
        .submit-button {
            width: 100%;
            padding: 18px;
            margin-top: 30px;
            border: none;
            background-color: #333; /* 黒 */
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            letter-spacing: 0.1em;
            font-family: serif;
            transition: background-color 0.3s;
        }

        .submit-button:hover {
            background-color: #000;
        }

        /* 注意書きテキスト */
        .note-text {
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
            font-family: sans-serif;
        }

        /* スマホ対応 */
        @media (max-width: 600px) {
            .container {
                width: 95%;
                padding: 20px;
            }
            h1 {
                font-size: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>出張買取予約フォーム</h1>

        <div class="label">お名前<span class="required">必須</span></div>
        <input type="text" id="name" placeholder="例：買取 太郎">

        <div class="label">お電話番号<span class="required">必須</span></div>
        <input type="tel" id="phone" placeholder="例：090-1234-5678">

        <div class="label">ご住所<span class="required">必須</span></div>
        <input type="text" id="address" placeholder="例：東京都渋谷区...">

        <div class="label">買取品目<span class="required">必須</span></div>
        <textarea id="items" rows="3" placeholder="例：ブランドバッグ、時計、ジャケットなど"></textarea>

        <div class="label">買取数量<span class="required">必須</span></div>
        <div class="note-text">※運搬の際の参考にしますのでおおまかで大丈夫です</div>
        <input type="text" id="quantity" placeholder="例：バッグ2点、服5着くらい">

        <div class="label">駐車場の有無<span class="required">必須</span></div>
        <div class="selection-group" id="parking-group">
            <button type="button" onclick="selectParking(this, '有り')">有り</button>
            <button type="button" onclick="selectParking(this, '無し')">無し</button>
        </div>

        <div class="label">希望日時<span class="required">必須</span></div>
        <div class="note-text">※第3希望までご入力ください</div>
        <div class="date-group">
            <span class="date-label">第1希望</span>
            <input type="datetime-local" id="date1">
            
            <span class="date-label">第2希望</span>
            <input type="datetime-local" id="date2">
            
            <span class="date-label">第3希望</span>
            <input type="datetime-local" id="date3">
        </div>

        <div class="label">その他注意事項<span class="optional">任意</span></div>
        <textarea id="notes" rows="3" placeholder="例：表札が違う、インターホンが鳴らないなど"></textarea>

        <button class="submit-button" onclick="submitForm()">予約を申し込む</button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        // グローバル変数
        let parkingSelection = '';

        // LIFF初期化
        document.addEventListener('DOMContentLoaded', function () {
            liff.init({
                liffId: '2005254357-zKma9BZk' // 元のIDを保持しています
            }).then(() => {
                console.log('LIFF初期化成功');
            }).catch((err) => {
                console.error('LIFF初期化失敗', err);
                // テスト用にアラートを出す場合はコメントアウトを外してください
                // alert('LIFF初期化エラー: ' + err); 
            });
        });

        // 駐車場選択処理
        function selectParking(element, value) {
            // 全てのボタンからactiveを外す
            const buttons = document.querySelectorAll('#parking-group button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // 選択されたボタンにactiveをつける
            element.classList.add('active');
            parkingSelection = value;
        }

        // 送信処理
        function submitForm() {
            // 値の取得
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const items = document.getElementById('items').value;
            const quantity = document.getElementById('quantity').value;
            const date1 = document.getElementById('date1').value;
            const date2 = document.getElementById('date2').value;
            const date3 = document.getElementById('date3').value;
            const notes = document.getElementById('notes').value;

            // バリデーション（必須項目のチェック）
            if (!name) { alert('お名前を入力してください。'); return; }
            if (!phone) { alert('お電話番号を入力してください。'); return; }
            if (!address) { alert('ご住所を入力してください。'); return; }
            if (!items) { alert('買取品目を入力してください。'); return; }
            if (!quantity) { alert('買取数量を入力してください。'); return; }
            if (!parkingSelection) { alert('駐車場の有無を選択してください。'); return; }
            if (!date1 || !date2 || !date3) { alert('希望日時を第3希望まで全て入力してください。'); return; }

            // 日時のフォーマット整形（見やすくする）
            const formatDate = (dateStr) => {
                if(!dateStr) return "";
                const d = new Date(dateStr);
                return `${d.getFullYear()}/${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`;
            };

            // 送信メッセージの作成
            const msgText = `≪出張買取予約≫\n\n` +
                            `【お名前】\n${name}\n\n` +
                            `【お電話番号】\n${phone}\n\n` +
                            `【ご住所】\n${address}\n\n` +
                            `【買取品目】\n${items}\n\n` +
                            `【買取数量】\n${quantity}\n\n` +
                            `【駐車場の有無】\n${parkingSelection}\n\n` +
                            `【希望日時】\n` +
                            `1. ${formatDate(date1)}\n` +
                            `2. ${formatDate(date2)}\n` +
                            `3. ${formatDate(date3)}\n\n` +
                            `【その他・注意事項】\n${notes || 'なし'}`;

            // LIFFでメッセージ送信
            if (!liff.isInClient()) {
                alert('LINEアプリ内から開いてください。\n\n送信内容プレビュー:\n' + msgText);
            } else {
                liff.sendMessages([{
                    type: 'text',
                    text: msgText
                }]).then(() => {
                    alert('予約内容を送信しました。参考までにお写真を事前にお送りいただけますと助かります');
                    liff.closeWindow();
                }).catch((err) => {
                    console.error('送信エラー', err);
                    alert('メッセージの送信に失敗しました。\n' + err);
                });
            }
        }
    </script>
</body>
</html>
