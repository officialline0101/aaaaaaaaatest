<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ハウスクリーン四万十 予約フォーム</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #45c4b7;
            --primary-dark: #3baea2;
            --text-main: #333333;
            --text-sub: #666666;
            --bg-body: #f4f7f6;
            --bg-card: #ffffff;
            --error: #e74c3c;
            --success: #2ecc71;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            padding-bottom: 100px; /* フッター用余白 */
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* --- ヘッダー --- */
        header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        header h1 {
            margin: 0;
            font-size: 18px;
            font-weight: 700;
        }
        header p {
            margin: 0;
            font-size: 12px;
            opacity: 0.9;
        }

        /* --- コンテナ --- */
        .container {
            max-width: 600px;
            margin: 20px auto;
            padding: 0 15px;
        }

        /* --- セクション共通 --- */
        .section-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        .section-title i {
            color: var(--primary);
            margin-right: 8px;
            font-size: 18px;
        }
        .badge-required {
            background: var(--error);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: auto;
        }
        .badge-any {
            background: #999;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: auto;
        }

        /* --- フォーム部品 --- */
        .form-group { margin-bottom: 15px; }
        label {
            display: block;
            font-size: 14px;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input[type="text"], input[type="tel"], textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px; /* iOSズーム防止 */
            box-sizing: border-box;
            background: #f9f9f9;
            transition: 0.3s;
            appearance: none;
        }
        input:focus, textarea:focus, select:focus {
            background: #fff;
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(69, 196, 183, 0.2);
        }

        /* --- アコーディオンメニュー --- */
        .accordion {
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 10px;
            background: #fff;
        }
        .accordion-header {
            padding: 15px;
            background: #fdfdfd;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            font-size: 15px;
            transition: background 0.2s;
        }
        .accordion-header:hover { background: #f0f8f7; }
        .accordion-header i { transition: transform 0.3s; color: #ccc; }
        .accordion.open .accordion-header {
            background: #f0f8f7;
            color: var(--primary-dark);
        }
        .accordion.open .accordion-header i {
            transform: rotate(180deg);
            color: var(--primary);
        }
        .accordion-content {
            display: none;
            padding: 15px;
            border-top: 1px solid #eee;
        }
        .accordion.open .accordion-content { display: block; animation: fadeIn 0.3s; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 選択ボタン（グリッドレイアウト） --- */
        .grid-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2列固定 */
            gap: 10px;
        }
        /* オプションは細かくてもいいので条件次第で列を変える */
        .grid-buttons.options {
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        }

        .select-btn {
            border: 1px solid #eee;
            background: #fff;
            padding: 15px 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 80px; /* テキスト量に合わせて少し高さを確保 */
        }
        .select-btn h5 {
            margin: 0 0 5px 0;
            font-size: 13px;
            font-weight: 500;
            line-height: 1.4;
        }
        .select-btn p {
            margin: 0;
            font-size: 11px;
            color: var(--text-sub);
            line-height: 1.3;
        }
        .select-btn .price {
            color: var(--primary);
            font-weight: bold;
            font-size: 11px;
            margin-top: 3px;
        }
        
        /* 選択状態 */
        .select-btn.active {
            border-color: var(--primary);
            background-color: rgba(69, 196, 183, 0.1);
            color: var(--primary-dark);
        }
        .select-btn.active::after {
            content: '\f00c';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 12px;
            color: var(--primary);
        }

        /* --- 駐車場トグル --- */
        .toggle-group { display: flex; gap: 10px; }
        .toggle-group button {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 6px;
            font-weight: bold;
            color: #999;
        }
        .toggle-group button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(69, 196, 183, 0.4);
        }

        /* --- 日時選択カスタムUI --- */
        .datetime-group {
            background: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            gap: 5px;
        }
        .datetime-group select {
            background: transparent;
            border: none;
            padding: 5px;
            font-weight: bold;
            color: var(--text-main);
        }
        .datetime-label {
            font-size: 12px;
            color: var(--text-sub);
            margin-bottom: 4px;
        }

        /* --- スティッキーフッター --- */
        .sticky-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px;
            box-sizing: border-box;
            display: flex;
            justify-content: center; /* ボタンを中央配置 */
            align-items: center;
            z-index: 1000;
        }
        .btn-submit {
            background: var(--text-main); /* 高級感のある黒/濃いグレー */
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s, background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            max-width: 400px;
        }
        .btn-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }
        .btn-submit:not(:disabled):active {
            transform: scale(0.95);
        }

        /* --- 確認エリア --- */
        #confirmation-area {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 14px;
            display: none; /* 初期非表示 */
        }

    </style>
</head>
<body>

    <header>
        <p>予約フォーム</p>
        <h1>ハウスクリーン四万十</h1>
    </header>

    <div class="container">

        <div class="section-card">
            <div class="section-title">
                <i class="fas fa-user-circle"></i> お客様情報
                <span class="badge-required">必須</span>
            </div>
            
            <div class="form-group">
                <label>お名前</label>
                <input type="text" id="name" placeholder="例：四万十 太郎" oninput="validateForm()">
            </div>
            <div class="form-group">
                <label>電話番号</label>
                <input type="tel" id="phone" placeholder="例：090-1234-5678" oninput="validateForm()">
            </div>
            <div class="form-group">
                <label>訪問先住所</label>
                <input type="text" id="address" placeholder="例：四万十市〇〇町1-2-3" oninput="validateForm()">
            </div>
            <div class="form-group">
                <label>駐車場の有無</label>
                <div class="toggle-group" id="parking-group">
                    <button type="button" onclick="setParking('有')">有</button>
                    <button type="button" onclick="setParking('無')">無</button>
                </div>
                <input type="hidden" id="parkingValue">
            </div>
        </div>

        <div class="section-card">
            <div class="section-title">
                <i class="fas fa-broom"></i> メニュー選択
                <span class="badge-required">必須</span>
            </div>
            <p style="font-size:12px; color:#666; margin-bottom:15px;">ご希望のカテゴリーを開いてメニューを選択してください（複数選択可）</p>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>エアコンクリーニング</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>スタンダードクリーニング</h5>
                            <p>（作業時間：約2時間）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>家庭用天井埋込タイプ</h5>
                            <p>（作業時間：約2〜3時間30分）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>業務用エアコンクリーニング</h5>
                            <p>（作業時間：約3時間〜）</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>換気扇クリーニング</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>換気扇クリーニング</h5>
                            <p>（作業時間：約2時間）</p>
                        </div>
                    </div>
                    <p style="font-size:12px; font-weight:bold; margin:10px 0 5px;">▼ オプション</p>
                    <div class="grid-buttons options option-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>お掃除機能付き（1台）</h5>
                            <div class="price">＋6,600円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>強い油汚れの除去（1台）</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>コンロセット</h5>
                            <div class="price">＋5,500円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>時間超過１時間ごと（1台）</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>アイランド型（1台）</h5>
                            <div class="price">＋2,200円</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>キッチンクリーニング</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>キッチンクリーニング</h5>
                            <p>（作業時間：約2時間）</p>
                        </div>
                    </div>
                    <p style="font-size:12px; font-weight:bold; margin:10px 0 5px;">▼ オプション</p>
                    <div class="grid-buttons options option-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>キッチンが3.5m以上またはL字型</h5>
                            <div class="price">＋5,500円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>シンク研磨サービス＆撥水コート仕上げ</h5>
                            <div class="price">＋4,400円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>壁紙染色10平米以下</h5>
                            <div class="price">＋13,200円</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>風呂・浴室クリーニング</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>風呂・浴室クリーニング</h5>
                            <p>（作業時間：約2時間）</p>
                        </div>
                    </div>
                    <p style="font-size:12px; font-weight:bold; margin:10px 0 5px;">▼ オプション</p>
                    <div class="grid-buttons options option-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>エプロン内部洗浄</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>エプロン内部高圧洗浄＋防カビ仕上げ</h5>
                            <div class="price">＋7,700円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>鏡の水アカ除去＋コーティング仕上げ</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>浴室防カビコート</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>1坪以上、タイル壁</h5>
                            <div class="price">＋5,500円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>特殊水アカ除去（0.5平米ごと）</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>1坪超（1平米ごと）</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>浴室乾燥機クリーニング</h5>
                            <div class="price">＋7,700円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>浴室換気扇 内部（1台）</h5>
                            <div class="price">＋5,500円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>時間超過１時間ごと</h5>
                            <div class="price">＋3,300円</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>トイレ・洗面所クリーニング</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>トイレクリーニング</h5>
                            <p>（作業時間：約1時間30分）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>洗面台クリーニング</h5>
                            <p>（作業時間：約1時間）</p>
                        </div>
                    </div>
                    <p style="font-size:12px; font-weight:bold; margin:10px 0 5px;">▼ オプション</p>
                    <div class="grid-buttons options option-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>同室内 便器追加（1基）</h5>
                            <div class="price">＋5,500円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>床ワックス塗布</h5>
                            <div class="price">＋1,100円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>壁紙染色10平米以下</h5>
                            <div class="price">＋13,200円</div>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'option')">
                            <h5>洗面台横幅1.2m以上</h5>
                            <div class="price">＋2,200円</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">
                    <span>ハウスクリーニング・家事代行</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="accordion-content">
                    <div class="grid-buttons menu-list">
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>洗濯機クリーニング（縦型）</h5>
                            <p>（約2時間）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>フローリングクリーニング</h5>
                            <p>（約2時間）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>壁紙染色</h5>
                            <p>（約3時間）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>その他のクリーニング</h5>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>お家まるごとパック</h5>
                            <p>（引越し前後・在宅）</p>
                        </div>
                        <div class="select-btn" onclick="toggleBtn(this, 'menu')">
                            <h5>家事代行サービス</h5>
                            <p>（1時間／スタッフ1名・2時間以上から利用）</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="section-title">
                <i class="far fa-calendar-alt"></i> 希望日時
                <span class="badge-required">必須</span>
            </div>
            
            <div class="datetime-label">第一希望（必須）</div>
            <div class="datetime-group">
                <select id="date1_day" onchange="updateDateTime('date1')"></select>
                <select id="date1_time" onchange="updateDateTime('date1')"></select>
                <input type="hidden" id="date1">
            </div>

            <div class="datetime-label">第二希望（必須）</div>
            <div class="datetime-group">
                <select id="date2_day" onchange="updateDateTime('date2')"></select>
                <select id="date2_time" onchange="updateDateTime('date2')"></select>
                <input type="hidden" id="date2">
            </div>

            <div class="datetime-label">第三希望（任意）</div>
            <div class="datetime-group">
                <select id="date3_day" onchange="updateDateTime('date3')"></select>
                <select id="date3_time" onchange="updateDateTime('date3')"></select>
                <input type="hidden" id="date3">
            </div>
        </div>

        <div class="section-card">
            <div class="section-title">
                <i class="far fa-comment-dots"></i> 備考・ご要望
                <span class="badge-any">任意</span>
            </div>
            <textarea id="message" placeholder="気になる汚れや、駐車場の詳細などございましたらご記入ください"></textarea>
        </div>

    </div>

    <div class="sticky-footer">
        <button class="btn-submit" id="submitBtn" onclick="submitForm()" disabled>
            予約する <i class="fas fa-paper-plane"></i>
        </button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        // --- 設定 ---
        const OPEN_HOUR = 9;
        const CLOSE_HOUR = 18;
        const DAYS_AHEAD = 90;

        // --- 初期化 ---
        document.addEventListener('DOMContentLoaded', () => {
            // LIFF Init
            liff.init({ liffId: '2005254357-zKma9BZk' }).catch(console.error);
            
            // 日時生成
            initDateSelects();

            // 復元
            restoreInput('name');
            restoreInput('phone');
            restoreInput('address');
            
            // アコーディオン初期開閉（最初だけ開けておく）
            document.querySelector('.accordion').classList.add('open');

            validateForm();
        });

        // --- アコーディオン制御 ---
        function toggleAccordion(header) {
            const parent = header.parentElement;
            parent.classList.toggle('open');
        }

        // --- ボタン選択 (トグル) ---
        function toggleBtn(el, type) {
            el.classList.toggle('active');
            
            if(el.classList.contains('active')) {
                el.setAttribute('data-selected', 'true');
            } else {
                el.removeAttribute('data-selected');
            }
            validateForm();
        }

        // --- 駐車場 ---
        function setParking(val) {
            document.getElementById('parkingValue').value = val;
            const btns = document.querySelectorAll('#parking-group button');
            btns.forEach(b => {
                if(b.textContent === val) b.classList.add('active');
                else b.classList.remove('active');
            });
            validateForm();
        }

        // --- 入力保存・復元 ---
        function saveInput(id) { localStorage.setItem(id, document.getElementById(id).value); }
        function restoreInput(id) {
            const v = localStorage.getItem(id);
            if(v) document.getElementById(id).value = v;
        }

        // --- 日時生成ロジック ---
        function initDateSelects() {
            const targets = ['date1', 'date2', 'date3'];
            const today = new Date();
            const JP_WD = ['日', '月', '火', '水', '木', '金', '土'];

            targets.forEach(id => {
                const daySel = document.getElementById(id + '_day');
                const timeSel = document.getElementById(id + '_time');

                // 日付
                daySel.innerHTML = '<option value="">日付を選択</option>';
                for(let i=1; i<=DAYS_AHEAD; i++) {
                    const d = new Date(today);
                    d.setDate(today.getDate() + i);
                    const y = d.getFullYear();
                    const m = ('0'+(d.getMonth()+1)).slice(-2);
                    const dd = ('0'+d.getDate()).slice(-2);
                    const wd = d.getDay();
                    const val = `${y}-${m}-${dd}`;
                    const txt = `${m}/${dd} (${JP_WD[wd]})`;
                    daySel.appendChild(new Option(txt, val));
                }

                // 時間
                timeSel.innerHTML = '<option value="">時間</option>';
                for(let h=OPEN_HOUR; h<=CLOSE_HOUR; h++) {
                    ['00', '30'].forEach(min => {
                        if(h === CLOSE_HOUR && min === '30') return;
                        const t = `${('0'+h).slice(-2)}:${min}`;
                        timeSel.appendChild(new Option(t, t));
                    });
                }
            });
        }

        function updateDateTime(baseId) {
            const d = document.getElementById(baseId + '_day').value;
            const t = document.getElementById(baseId + '_time').value;
            document.getElementById(baseId).value = (d && t) ? `${d}T${t}` : '';
            validateForm();
        }

        // --- バリデーション ---
        function validateForm() {
            // 値取得
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const parking = document.getElementById('parkingValue').value;
            const d1 = document.getElementById('date1').value;
            const d2 = document.getElementById('date2').value;
            
            // メニュー選択数
            const selectedMenus = document.querySelectorAll('.menu-list .select-btn[data-selected="true"]');
            
            // 必須チェック
            const isValid = name && phone && address && parking && d1 && d2 && (selectedMenus.length > 0);
            
            // ボタン活性化
            const btn = document.getElementById('submitBtn');
            btn.disabled = !isValid;
            btn.innerHTML = isValid ? '予約をリクエストする <i class="fas fa-paper-plane"></i>' : '入力内容を確認してください';
        }

        function formatDateTime(isoStr) {
            if(!isoStr) return '';
            const [d, t] = isoStr.split('T');
            const [y, mm, dd] = d.split('-');
            return `${y}年${mm}月${dd}日 ${t}`;
        }

        // --- 送信処理 ---
        function submitForm() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const parking = document.getElementById('parkingValue').value;
            const d1 = document.getElementById('date1').value;
            const d2 = document.getElementById('date2').value;
            const d3 = document.getElementById('date3').value;
            const msg = document.getElementById('message').value;

            // 選択項目収集
            const menus = [];
            document.querySelectorAll('.menu-list .select-btn[data-selected="true"]').forEach(el => {
                menus.push(el.querySelector('h5').textContent);
            });
            const options = [];
            document.querySelectorAll('.option-list .select-btn[data-selected="true"]').forEach(el => {
                options.push(el.querySelector('h5').textContent);
            });

            // 送信テキスト作成
            const text = [
                '【予約リクエスト】',
                '',
                '《お客様情報》',
                `名　前：${name}`,
                `電　話：${phone}`,
                `住　所：${address}`,
                `駐車場：${parking}`,
                '',
                '《ご依頼内容》',
                `■メニュー：\n${menus.join('\n')}`,
                options.length ? `■オプション：\n${options.join('\n')}` : '■オプション：なし',
                '',
                '《希望日時》',
                `第一：${formatDateTime(d1)}`,
                `第二：${formatDateTime(d2)}`,
                d3 ? `第三：${formatDateTime(d3)}` : '第三：指定なし',
                '',
                '《備考》',
                msg || 'なし'
            ].join('\n');

            // 送信
            if (!liff.isInClient()) {
                alert('LINEアプリ内から開いてください。\n\n' + text);
                return;
            }

            liff.sendMessages([{ type: 'text', text: text }])
                .then(() => {
                    liff.closeWindow();
                })
                .catch(err => {
                    alert('送信に失敗しました');
                });
        }
    </script>
</body>
</html>
