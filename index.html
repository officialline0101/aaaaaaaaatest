<!DOCTYPE html>
<html lang="ja">
<head>
<base target="_top">
<meta http-equiv="content-type" charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@3.2/dist/vue.global.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- vue 3 Datapicker css -->
<link rel="stylesheet" href="https://unpkg.com/@vuepic/vue-datepicker@latest/dist/main.css">
<!-- flatpickr css -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<!-- LIFF SDK -->
<script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
<style>
    .dp__button {
        display: none;
    }
    * {
    	font-family:"游ゴシック Medium",YuGothic,YuGothicM,"Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Pro",メイリオ,Meiryo,sans-serif;
    }
    body {
    	margin:0;
    }
    header {
    	padding: 5px;
    	background-color: #333;
    	position: relative;
    }
    h2 {
    	text-align:center;
    	color: #fff;
    	margin: 10px;
    }
    .btn-group>.btn, .btn-group-vertical>.btn {
        float: none;
        display: inline-block;
    }
    .btn-info {
        color: #fff;
        background-color: #333;
        border-color: #FFF;
    }
    .btn-info:focus, .btn-info:active, .btn-info.active, .open>.dropdown-toggle.btn-info, .check {
        color: #333;
        background-color: #fff;
        border: solid 2px #333;
    }
    .container {
    	margin: 40px 0;
    }
    .form-group {
        margin-bottom: 20px;
    }
    .use-span {
    	width: 25%;
    	font-size: 12px;
    	padding: 6px;
    	text-align: center;
    }
    .regist {
    	background:red;
    	border-color:red;
    	width: 100%;
    	padding: 20px 0;
    	margin: 20px 0;
    	color: #FFFFFF;
    }
    #error{
        display:none;
    }
    #section { display: none; }
    #family_count { display: none; }
    .dp__input {
        display: block;
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        padding-left: 24px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    }
    .dp__action_buttons {
        flex:auto;
    }
    input[type=radio] {
        display: none;
    }
    .flatpickr-day {
      position: relative;
    }
    .availability-badge {
      position: absolute;
      top: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      padding: 2px 4px;
      font-size: 10px;
      line-height: 1;
      color: #000;
    }
</style>
</head>
<body>
<header>
	<h2>予約フォーム</h2>
</header>
<section id="app">
	<div class="container" id="bring">
        <!-- <form id="apply"> -->

            <!-- customer_name -->  
            <div class="form-group">
                <label>お客様名（カタカナ）</label>
                <input v-model="name" type="text" name="customer_name" class="form-control" required>
            </div>

            <div class="form-group">
                <label>電話番号</label>
                <input v-model="tel" type="text" name="customer_tel" class="form-control" required>
            </div>

            <!-- place -->
            <div class="form-group">
                <label>ご来店回数</label>
                <div class="btn-group" style="width:100%;">
                    <label class="btn btn-info" style="width: 49%;" for="first" :class="number === '初めて' ? 'check' : ''">
                        <input value="初めて" type="radio" v-model="number" id="first">初めて
                    </label>
                    <label class="btn btn-info" style="width: 49%;" for="second" :class="number === '2回目以降' ? 'check' : ''">
                        <input value="2回目以降" type="radio" v-model="number" id="second">2回目以降
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>症状</label>
                <div class="btn-group" style="width:100%;">
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '頭痛・偏頭痛' ? 'check' : ''" for="one">
                        <input name="place" value="頭痛・偏頭痛" type="radio" required v-model="syoujou" id="one">頭痛・偏頭痛
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '交通事故施術' ? 'check' : ''" for="two">
                        <input name="place" value="交通事故施術" type="radio" required v-model="syoujou" id="two">交通事故施術
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '肩こり・腕のしびれ' ? 'check' : ''" for="three">
                        <input name="place" value="肩こり・腕のしびれ" type="radio" required v-model="syoujou" id="three">肩こり・腕のしびれ
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '臀部・下肢の痛みや痺れ' ? 'check' : ''" for="four">
                        <input name="place" value="臀部・下肢の痛みや痺れ" type="radio" required v-model="syoujou" id="four">臀部・下肢の痛みや痺れ
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '顎関節症' ? 'check' : ''" for="five">
                        <input name="place" value="顎関節症" type="radio" required v-model="syoujou" id="five">顎関節症
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === '産後骨盤矯正' ? 'check' : ''" for="six">
                        <input name="place" value="産後骨盤矯正" type="radio" required v-model="syoujou" id="six">産後骨盤矯正
                    </label>
                    <label class="btn btn-info" style="width: 100%;" :class="syoujou === 'その他' ? 'check' : ''" for="seven">
                        <input name="place" value="その他" type="radio" required v-model="syoujou" id="seven">その他
                    </label>
                </div>
            </div>

            <!-- Date picker -->
            <div class="form-group">
                <label>ご予約希望日時</label>
                <VueDatePicker v-model="datepicker" placeholder="日付を選択" :inline="true" :mode="'single'" />
            </div>
            <div class="form-group">
                <div class="input-group">
                    <label>ご希望の時間</label>
                    <div class="btn-group" style="width:100%;">
                        <label class="btn btn-info" style="width: 24%;" for="one">
                            <input value="10:00" type="radio" v-model="time">10:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="two">
                            <input value="11:00" type="radio" v-model="time">11:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="three">
                            <input value="12:00" type="radio" v-model="time">12:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="four">
                            <input value="13:00" type="radio" v-model="time">13:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="five">
                            <input value="14:00" type="radio" v-model="time">14:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="six">
                            <input value="15:00" type="radio" v-model="time">15:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="seven">
                            <input value="16:00" type="radio" v-model="time">16:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="eight">
                            <input value="17:00" type="radio" v-model="time">17:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="nine">
                            <input value="18:00" type="radio" v-model="time">18:00
                        </label>
                        <label class="btn btn-info" style="width: 24%;" for="ten">
                            <input value="19:00" type="radio" v-model="time">19:00
                        </label>
                    </div>
                </div>
            </div>

            <!-- Message -->
            <div class="form-group">
                <label>その他ご要望</label>
                <textarea v-model="textarea" class="form-control" rows="4"></textarea>
            </div>

            <div class="form-group">
                <label>メールアドレス</label>
                <input v-model="email" type="email" name="customer_email" class="form-control" required>
            </div>

            <!-- Submit Button -->
            <div class="form-group">
                <button @click="done" class="btn btn-primary regist">送信</button>
            </div>
            <div class="form-group" id="error">
                <label style="color:red;">メッセージ送信に失敗しました。もう一度お試しください。</label>
            </div>
    </div>
</section>
<script>
Vue.createApp({
    data() {
        return {
            name: '',
            tel: '',
            number: '',
            syoujou: '',
            datepicker: '',
            time: '',
            textarea: '',
            email: '',
            liffId: '2005254357-zKma9BZk'
        }
    },
    methods: {
        async done() {
            const sendMessage = async (message) => {
                try {
                    const profile = await liff.getProfile();
                    liff.sendMessages([
                        {
                            type: 'text',
                            text: message
                        }
                    ]);
                    alert("メッセージが送信されました。");
                } catch (error) {
                    document.getElementById('error').style.display = 'block';
                    console.error('メッセージ送信に失敗しました:', error);
                }
            };

            const message = `
                お客様名: ${this.name}
                電話番号: ${this.tel}
                ご来店回数: ${this.number}
                症状: ${this.syoujou}
                ご予約希望日: ${this.datepicker}
                ご希望の時間: ${this.time}
                その他ご要望: ${this.textarea}
                メールアドレス: ${this.email}
            `;
            
            try {
                await sendMessage(message);
            } catch (error) {
                console.error('Error sending message:', error);
            }
        },
        async initLiff() {
            try {
                await liff.init({ liffId: this.liffId });
                if (!liff.isLoggedIn()) {
                    liff.login();
                }
            } catch (error) {
                console.error('LIFF初期化に失敗しました:', error);
            }
        }
    },
    mounted() {
        this.initLiff();
    }
}).mount('#app');
</script>
<script src="https://unpkg.com/@vuepic/vue-datepicker@latest/dist/main.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</body>
</html>
