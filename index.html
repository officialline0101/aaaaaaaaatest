<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アンケートフォーム</title>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- 全体のリセットとベース設定 --- */
        body {
            font-family: "Noto Sans JP", sans-serif;
            background-color: #f4f1ea; /* ナチュラルな生成り色 */
            color: #4a4a4a;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px 0;
        }

        /* --- コンテナデザイン --- */
        .container {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(93, 64, 55, 0.15); /* 優しい茶色の影 */
            width: 96%;
            max-width: 500px;
            padding: 25px;
            box-sizing: border-box;
            border-top: 5px solid #6d4c41; /* 木目調のアクセントバー */
        }

        /* --- 見出しデザイン --- */
        h1 {
            font-family: "Noto Serif JP", serif; /* 明朝体で高級感 */
            color: #6d4c41; /* ダークブラウン */
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 15px;
            line-height: 1.4;
        }

        /* --- 説明テキスト --- */
        .info-text {
            font-size: 14px;
            color: #555;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #a1887f; /* アクセント */
            line-height: 1.6;
        }

        /* --- ラベル（質問文） --- */
        .label {
            display: block;
            margin-top: 25px;
            margin-bottom: 12px;
            font-weight: 700;
            color: #3e2723; /* 濃い焦げ茶 */
            font-size: 16px;
            position: relative;
            padding-left: 10px;
        }
        
        /* ラベルの横棒装飾 */
        .label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 100%;
            background-color: #8d6e63;
            border-radius: 2px;
        }

        /* --- ★今回追加：クーポン案内メッセージのデザイン --- */
        .coupon-notice {
            background: linear-gradient(to right, #fff8e1, #fff); /* ゴールド系の淡いグラデーション */
            border: 1px solid #ffecb3;
            color: #8d6e63;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .coupon-notice i {
            color: #d4a017; /* ゴールドアイコン */
            font-size: 18px;
        }

        /* --- 入力フィールド --- */
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 16px;
            background-color: #fafafa;
            transition: all 0.3s;
            resize: vertical;
        }

        textarea:focus {
            border-color: #8d6e63;
            background-color: #fff;
            outline: none;
            box-shadow: 0 0 0 3px rgba(141, 110, 99, 0.2);
        }

        /* --- 必須マーク --- */
        .required {
            background-color: #bf360c; /* 落ち着いた赤レンガ色 */
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-right: 8px;
            vertical-align: middle;
            font-weight: normal;
        }

        /* --- ボタンエリア --- */
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }

        /* --- 選択ボタンのデザイン --- */
        .button-group button {
            flex: 1 1 30%; /* 3列配置を基本に */
            padding: 12px 5px;
            border: 1px solid #d7ccc8;
            border-radius: 6px;
            background-color: #fff;
            color: #5d4037;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        /* スマホなど画面が狭いときは2列にする等の調整 */
        @media (max-width: 400px) {
            .button-group button {
                flex: 1 1 45%;
            }
        }

        .button-group button:hover {
            background-color: #efebe9;
        }

        /* 選択状態（アクティブ）のデザイン */
        .button-group button.active {
            background-color: #6d4c41; /* 木の色 */
            color: #fff;
            border-color: #6d4c41;
            font-weight: bold;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            transform: translateY(1px);
        }

        /* --- 送信ボタン --- */
        .submit-button {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #5d4037, #4e342e); /* リッチなブラウン */
            color: #fff;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 10px rgba(93, 64, 55, 0.4);
            transition: transform 0.2s;
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 14px rgba(93, 64, 55, 0.5);
        }

        .submit-button:active {
            transform: translateY(0);
        }

        /* --- 右端の固定ナビ（シンプル化） --- */
        .side-nav {
            position: fixed;
            right: 10px;
            bottom: 20px;
            z-index: 1000;
        }
        .side-nav a {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            background-color: #8d6e63;
            color: white;
            border-radius: 50%;
            text-decoration: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            font-size: 20px;
        }

    </style>
</head>

<body>

    <div class="container">
        <h1>KwaatsiWam<br>アンケートフォーム</h1>
        <div class="info-text">
            ご来店ありがとうございます。<br>
            以下の項目にご回答の上、最後に【送信】ボタンを押してください。
        </div>

        <div class="label"><span class="required">必須</span>お名前を教えてください。</div>
        <textarea id="message" rows="1" placeholder="お名前を入力してください"></textarea>

        <div class="label">性別を教えてください。</div>
        <div class="button-group priority-buttons">
            <button type="button" onclick="selectSingle(this, 'priority')">男性</button>
            <button type="button" onclick="selectSingle(this, 'priority')">女性</button>
            <button type="button" onclick="selectSingle(this, 'priority')">その他</button>
        </div>

        <div class="label"><span class="required">必須</span>何月生まれですか？</div>
        <div class="coupon-notice">
            <i class="fas fa-gift"></i>
            <span>バースデークーポンを送らせていただきます</span>
        </div>
        
        <div class="button-group demand-buttons">
            <button type="button" onclick="selectSingle(this, 'demand')">1月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">2月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">3月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">4月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">5月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">6月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">7月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">8月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">9月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">10月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">11月</button>
            <button type="button" onclick="selectSingle(this, 'demand')">12月</button>
        </div>

        <div class="label"><span class="required">必須</span>ご年代を教えてください。</div>
        <div class="button-group chance-buttons">
            <button type="button" onclick="selectSingle(this, 'chance')">10代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">20代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">30代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">40代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">50代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">60代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">70代</button>
            <button type="button" onclick="selectSingle(this, 'chance')">80代以上</button>
        </div>

        <div class="label"><span class="required">必須</span>普段ご利用されているメニューを教えてください。（複数選択可）</div>
        <div class="button-group Introduction-buttons">
            <button type="button" onclick="selectMulti(this)">カット</button>
            <button type="button" onclick="selectMulti(this)">カラー</button>
            <button type="button" onclick="selectMulti(this)">ヘナカラー</button>
            <button type="button" onclick="selectMulti(this)">縮毛矯正</button>
            <button type="button" onclick="selectMulti(this)">パーマ</button>
            <button type="button" onclick="selectMulti(this)">トリートメント</button>
            <button type="button" onclick="selectMulti(this)">ヘッドスパ</button>
            <button type="button" onclick="selectMulti(this)">その他</button>
        </div>

        <div class="label">興味のあるメニューを教えてください。（複数選択可）</div>
        <div class="coupon-notice">
            <i class="fas fa-tag"></i>
            <span>キャンペーン案内や割引クーポン送らせていただきます</span>
        </div>

        <div class="button-group delivery-buttons">
            <button type="button" onclick="selectMulti(this)">縮毛矯正</button>
            <button type="button" onclick="selectMulti(this)">パーマ</button>
            <button type="button" onclick="selectMulti(this)">カラー</button>
            <button type="button" onclick="selectMulti(this)">ヘナカラー</button>
            <button type="button" onclick="selectMulti(this)">アクセサリーカラー等</button>
            <button type="button" onclick="selectMulti(this)">トリートメント</button>
            <button type="button" onclick="selectMulti(this)">ヘッドスパ</button>
            <button type="button" onclick="selectMulti(this)">眉毛カット</button>
            <button type="button" onclick="selectMulti(this)">まつ毛パーマ</button>
            <button type="button" onclick="selectMulti(this)">健康食品・サプリ</button>
            <button type="button" onclick="selectMulti(this)">その他</button>
        </div>

        <button id="submitArea" class="submit-button" onclick="submitForm()">送信</button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
        // データ保持用変数
        let formData = {
            priority: '', // 性別
            demand: '',   // 誕生月
            chance: '',   // 年代
            introduction: [], // 利用メニュー(配列)
            delivery: []  // 興味メニュー(配列)
        };

        // LIFF初期化
        document.addEventListener('DOMContentLoaded', function () {
            liff.init({
                liffId: '2005254357-zKma9BZk' // LIFF ID
            }).then(() => {
                console.log('LIFF初期化成功');
            }).catch((err) => {
                console.error('LIFF初期化失敗', err);
            });
        });

        // 単一選択用関数（性別・誕生月・年代）
        function selectSingle(element, key) {
            // 親要素内のすべてのボタンからactiveを削除
            const parent = element.parentElement;
            const buttons = parent.querySelectorAll('button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // クリックされたボタンにactiveを追加
            element.classList.add('active');
            
            // データを保存
            formData[key] = element.innerText;
        }

        // 複数選択用関数（利用メニュー・興味メニュー）
        function selectMulti(element) {
            element.classList.toggle('active');
        }

        // 送信処理
        function submitForm() {
            // 名前取得
            const message = document.getElementById('message').value;

            // 複数選択項目の集計
            // 利用メニュー
            const introBtns = document.querySelectorAll('.Introduction-buttons button.active');
            formData.introduction = Array.from(introBtns).map(btn => btn.innerText);
            
            // 興味メニュー
            const deliveryBtns = document.querySelectorAll('.delivery-buttons button.active');
            formData.delivery = Array.from(deliveryBtns).map(btn => btn.innerText);

            // エラーチェック
            if (!message) {
                alert('お名前を入力してください。');
                return;
            }
            if (!formData.demand) {
                alert('誕生日月をご選択ください。');
                return;
            }
            if (!formData.chance) {
                alert('ご年代をご選択ください。');
                return;
            }
            if (formData.introduction.length === 0) {
                alert('普段ご利用されているメニューをご選択ください。');
                return;
            }

            // LINE送信処理
            if (!liff.isLoggedIn()) {
                // PCブラウザ確認用アラート（LIFF外の場合）
                alert('LIFF外で実行されています。本来はここでLINE送信されます。');
                console.log('送信データ:', { name: message, ...formData });
                return;
            }

            liff.sendMessages([
                {
                    type: 'text',
                    text: `≪アンケート≫\n【お名前】\n・${message}\n\n【性別】\n・${formData.priority || '未回答'}\n\n【誕生月】\n・${formData.demand}\n\n【ご年代】\n・${formData.chance}\n\n【利用メニュー】\n・${formData.introduction.join(', ')}\n\n【興味メニュー】\n・${formData.delivery.join(', ') || 'なし'}`
                },
                {
                    type: 'text',
                    text: "クーポン番号-3h3ga33"
                }
            ]).then(() => {
                alert('ご記入ありがとうございます。');
                liff.closeWindow();
            }).catch((err) => {
                console.error('送信エラー', err);
                alert('送信エラー: ' + err); 
            });
        }
    </script>
</body>
</html>
